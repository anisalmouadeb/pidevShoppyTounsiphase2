@model IEnumerable<pidevShoppyTounsi.Models.Shelf>
@using pidevShoppyTounsi.Controllers
@{
    ViewBag.Title = "ListShelfs";
}
@if (LoginController.TokenConnect != "")
{ Layout = "~/Views/Shared/ConnectedClient.cshtml"; }
else
{ Layout = "~/Views/Shared/NotConnectedClient.cshtml"; }
<br />
<br />
<br />
<br />
<div class="page-header pl-4 pr-4">

    <figure class="product-image">
        <iframe src="https://momento360.com/e/u/6a4278666cc74761adf1db390d5eeccc?utm_campaign=embed&utm_source=other&heading=187.8&pitch=-19.2&field-of-view=75&size=medium"
                width="1590" height="450">
        </iframe>
    </figure>


</div>
<br />
<br />
<br />
<br />
<main class="main account">

    <div class="page-content mt-4 mb-10 pb-6">
        <div class="container">



            <nav class="breadcrumb-nav">
                <div class="container">
                    <ul class="breadcrumb">
                        <li><i class="d-icon-mode-list"></i></li>
                        <li>List of Shelfs </li>
                    </ul>
                </div>
            </nav>

            @foreach (var item in Model)
            {
                <br />
                @Html.HiddenFor(modelItem => item.shelfId, new { htmlAttributes = new { @id = item.shelfId } })
                <div class="row gutter-lg ">



                    <div class="product product-single row">

                        <div class="col-md-4">

                            <figure class="product-image">
                                <iframe src="https://momento360.com/e/u/6a4278666cc74761adf1db390d5eeccc?utm_campaign=embed&utm_source=other&heading=187.8&pitch=-19.2&field-of-view=75&size=medium"
                                        width="490" height="400"></iframe>
                            </figure>

                        </div>
                        <div class="col-md-8">
                            <br />  <br />  <br />
                            <div class="product-details" style="margin-left:120px">
                                <div class="product-cat">
                                    <a href="shop-grid-3col.html">@Html.DisplayFor(modelItem => item.type)</a>
                                </div>
                                <h1 class="product-name mt-3">@Html.DisplayFor(modelItem => item.shelfname)</h1>





                                @{int nb = 0;
                                }
                                @foreach (var s in ViewBag.shelfRating)
                                {
                                    if (@s.shelf.shelfId == item.shelfId)
                                    {
                                        nb++;
                                    }

                                }
                                @{int nb2 = 0; }
                                @{int rate = 0;}

                                @foreach (var s in ViewBag.shelfRating)
                                {
                                    if (@s.user.userId == LoginController.ConnectedId && @s.shelf.shelfId == item.shelfId)
                                    {
                                        nb2++;
                                        rate = s.rating;
                                    }

                                }
                                <div class="product-price">  Rating </div>
                                @if ((item.rating) == 0)
                                {
                                    <div class="ratings-container">
                                        <div class="ratings-full">
                                            <span class="ratings" style="width:0%"></span>
                                            <span class="tooltiptext tooltip-top"></span>
                                        </div>
                                        <a class="link-to-tab rating-reviews">
                                            @if (nb2 > 0)
                                            {
                                                <div>
                                                    (  @nb reviews ) (your rate is @rate)
                                                </div>
                                            }
                                            else
                                            { <div>
                                                    (  @nb reviews )
                                                </div>}

                                            )

                                        </a>
                                    </div>
                                }
                                @if ((item.rating) == 1)
                                {
                                    <div class="ratings-container">
                                        <div class="ratings-full">
                                            <span class="ratings" style="width:20%"></span>
                                            <span class="tooltiptext tooltip-top"></span>
                                        </div>
                                        <a class="link-to-tab rating-reviews">
                                            @if (nb2 > 0)
                                            {
                                                <div>
                                                    (  @nb reviews ) (your rate is @rate)
                                                </div>
                                            }
                                            else
                                            { <div>
                                                    (  @nb reviews )
                                                </div>}
                                        </a>
                                    </div>
                                }
                                @if ((item.rating) == 2)
                                {
                                    <div class="ratings-container">
                                        <div class="ratings-full">
                                            <span class="ratings" style="width:40%"></span>
                                            <span class="tooltiptext tooltip-top"></span>
                                        </div>
                                        <a class="link-to-tab rating-reviews">
                                            @if (nb2 > 0)
                                            {
                                                <div>
                                                    (  @nb reviews ) (your rate is @rate)
                                                </div>
                                            }
                                            else
                                            { <div>
                                                    (  @nb reviews )
                                                </div>}
                                        </a>
                                    </div>
                                }
                                @if ((item.rating) == 3)
                                {
                                    <div class="ratings-container">
                                        <div class="ratings-full">
                                            <span class="ratings" style="width:60%"></span>
                                            <span class="tooltiptext tooltip-top"></span>
                                        </div>
                                        <a class="link-to-tab rating-reviews">
                                            @if (nb2 > 0)
                                            {
                                                <div>
                                                    (  @nb reviews ) (your rate is @rate)
                                                </div>
                                            }
                                            else
                                            { <div>
                                                    (  @nb reviews )
                                                </div>}
                                        </a>
                                    </div>
                                }
                                @if ((item.rating) == 4)
                                {
                                    <div class="ratings-container">
                                        <div class="ratings-full">
                                            <span class="ratings" style="width:80%"></span>
                                            <span class="tooltiptext tooltip-top"></span>
                                        </div>
                                        <a class="link-to-tab rating-reviews">
                                            @if (nb2 > 0)
                                            {
                                                <div>
                                                    (  @nb reviews ) (your rate is @rate)
                                                </div>
                                            }
                                            else
                                            { <div>
                                                    (  @nb reviews )
                                                </div>}
                                        </a>
                                    </div>
                                }
                                @if ((item.rating) == 5)
                                {
                                    <div class="ratings-container">
                                        <div class="ratings-full">
                                            <span class="ratings" style="width:100%"></span>
                                            <span class="tooltiptext tooltip-top"></span>
                                        </div>
                                        <a class="link-to-tab rating-reviews">
                                            @if (nb2 > 0)
                                            {
                                                <div>
                                                    (  @nb reviews ) (your rate is @rate)
                                                </div>
                                            }
                                            else
                                            { <div>
                                                    (  @nb reviews )
                                                </div>}
                                        </a>
                                    </div>
                                }






                                <hr class="product-divider">

                                <div class="product-form product-qty">
                                    <div class="product-form-group">
                                        @using (Html.BeginForm("AddRate", "Shelf", FormMethod.Post))
                                        {

                                            <div class="input-group mr-2">
                                                @Html.Hidden("id", item.shelfId)
                                                @Html.DropDownList("rate", Enumerable.Range(1, 5).Select(i => new SelectListItem { Text = i.ToString(), Value = i.ToString() }), "Rate Now")

                                            </div>
                                            if (nb2 > 0)
                                            { <button type="submit" class="btn btn-success">Update Rate <i class="fa fa-star"></i></button>}
                                            else
                                            { <button type="submit" class="btn btn-success">Add Rate <i class="fa fa-star"></i></button>}

                                        }

                                        <button class="btn btn-primary ls-normal font-weight-semi-bold" onclick="location.href='ShelfListOfProducts/'+@item.shelfId">
                                            See products
                                        </button>
                                    </div>
                                </div>

                                <hr class="product-divider mb-3">



                            </div>
                        </div>

                    </div>



                </div>



                <br />
                <hr style="border:double" />
            }
        </div>


                </div>
      
</main>

<br />
<br />
<br />




<script src="vendor/jquery/jquery.min.js"></script>
<script src="vendor/jquery.plugin/jquery.plugin.min.js"></script>
<script src="vendor/jquery.countdown/jquery.countdown.min.js"></script>
<script src="vendor/magnific-popup/jquery.magnific-popup.min.js"></script>